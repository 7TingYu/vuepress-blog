---
title: interview ES + TS(一)
date: 2022-01-20
tags:
 - interview
categories:
 - interview
---

# 作用域 & 作用域链

## 作用域(scope)

防止不同范围的变量之间互相干扰 的 变量的可用范围


### 全局作用域

不属于任何函数的外部范围

保存在全局作用域的变量称为全局变量


特点：

- 优点: 可反复使用
- 缺点: 全局污染——开发时禁止使用


### 函数作用域


一个函数内的范围称为函数作用域


保存在函数作用域内的变量称为局部变量


> 形参变量也是函数内的局部变量

特点:

- 优点: 不会被污染
- 缺点: 无法反复使用


**强调: 只有函数的\{}，才能形成作用域**

**强调: JS中没有块级作用域**


- 除函数\{}之外的其余\{}，都不是作用域。
- 都拦不住内部的变量超出\{}的范围影响外部程序



## 作用域链 （scopes / scope chain）


每个函数在定义时，就已经规划好了自己专属的一个查找变量的路线图，称为作用域链

**一个函数可用的所有作用域串联起来，就行成了当前函数的作用域链。**



Js中只有两种局部变量:

- 函数内**var**出来的
- 函数的**形参**变量



## 作用域的本质

JS中，**作用域和作用域链都是对象结构**


- 全局作用域其实是一个 window 的对象解构 
  - 所有全局变量和全局函数都是 window 对象的成员
- 对于还未调用函数作用域链上暂时只有一个作用域Global，既全局作用域对象window


总结: **函数作用域**

其实是js引擎在调用函数时才临时创建的一个作用域对象。其中保存函数的局部变量。而函数调用完，函数作用域对象就释放了。

> JS中函数作用域对象，还有个别名——”活动的对象(Actived Object)”简称, AO。

### 函数调用过程

- 创建函数保存局部变量
- 逐步执行
- 释放



## 闭包

既重用变量又保护变量不被污染的一种编程方法。

只要希望给一个函数，保存一个即可反复使用，又不会被外界污染的专属局部变量时，就用闭包

**强调:因为内层函数只是定义，未加()调用。所以，内层函数中的代码不执行！**

所有函数调用完只清空作用域链中离自己近的一个作用域

**闭包就是每次调用外层函数时，临时创建的函数作用域对象**

### 闭包如何形成

**外层函数调用后，外层函数的作用域对象，被返回的内层函数的作用域链引用着，无法释放，就形成了闭包对象**

如何释放不用的闭包对象？将保存内层函数对象的变量赋值为null